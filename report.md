---
### Проблема №1: відсутні OpenAPI + типізовані моделі у FastAPI

**Файл:** secure-arch-lab/main.py


```python
@app.get("/user")
def get_user(id):
    # ❌ no typing, no response_model, no validation
    return {"id": id, "name": "Alice"}
```

**Пропозиції:**
1) використовувати pydantic для створення моделі та типізації
2) для маршрутів обов'язково використовувати response_model
---
---
### Проблема №2: порушення DTO та небезпечний парсинг

**Файл:** secure-arch-lab/main.py


```python
    data = request.json()  # ❌ no schema, unsafe parsing
```

**Пропозиції:**
1) використовувати pydantic для створення моделі та типізації
2) не використовувати request.json(), а приймати дані через pydantic модель у параметрах функції
---
---
### Проблема №3: порушення контрольованості архітектури та PaS

**Файл:** secure-arch-lab/main.py


```python
if data["password"] == "secret":
```

**Пропозиції:**
1) використовувати Policy-as-Code, щоб правила доступу були контрольованими
2) не використовувати харкод значень у логіці доступу
3) перевіряти пароль через БД використовуючи хеш та ф-цію verify
---
### Проблема №4: відкритий доступ патерн контрольованості та PaS, тому що дозволяє з'єднання з будь якоЇ ip адреси

**Файл:** secure-arch-lab/main.tf


```python
cidr_blocks = ["0.0.0.0/0"]  # ❌ відкрита зона
```

**Пропозиції:**
1) дозволити доступ тільки для необхідних ip
2) не використовувати 0.0.0.0/0, якщо це не публічний сервіс, який має бути відкритим
---
### Проблема №5: відсутність security гейтів (gitleaks, semgrep) порушує патерн контрольованості архітектури

**Файл:** secure-arch-lab/ci.yml


```yml
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Build container
        run: docker build -t user-api .
```

**Пропозиції:**
1) додати gitleaks для перевірки витоків секретів
2) додати semgrep для статичного аналізу коду
3) забезпечити, щоб CI зупинив пайплайн при виявленні критичних порушень
---